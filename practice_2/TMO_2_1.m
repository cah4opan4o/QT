% Параметры
N = 400; % Количество точек во временном ряде
K = 800; % Количество реализаций
mu = 8;  % Среднее значение
sigma = 2;  % Стандартное отклонение

% Генерация матрицы Xi (K реализаций белого шума)
Xi = mu + sigma * randn(N, K);

% 1. График среднего по ансамблю и по каждой реализации
% Среднее по ансамблю (по столбцам, то есть усреднение строк)
mu_ensemble = mean(Xi, 2);

% Среднее по каждой реализации (по строкам, то есть усреднение столбцов)
mu_realization = mean(Xi, 1);

% Построение графиков
figure;
subplot(3,1,1);
plot(1:N, mu_ensemble, 'b', 'LineWidth', 2); 
xlabel('n');
ylabel('Среднее по ансамблю');
title('Среднее по ансамблю \mu_{\xi}[n]');

subplot(3,1,2);
plot(1:K, mu_realization, 'r', 'LineWidth', 2);
xlabel('Реализация');
ylabel('Среднее по реализации');
title('Среднее по каждой реализации \mu_{\xi}[n]');

subplot(3,1,3);
plot(1:K, mu_realization, 'r', 'LineWidth', 2);
plot(1:N, mu_ensemble, 'b--', 'LineWidth', 2); 


% Вывод: Проверьте эргодичность процесса, сравнив графики.
% Если средние по ансамблю и по реализации примерно совпадают, то процесс эргодический.

% 2. Построение диаграмм рассеяния для трёх разных значений n_i и n_j
% Выбираем три уникальные пары значений n_i и n_j
n_pairs = [50, 100; 150, 200; 250, 300]; 

figure;
for i = 1:3
    n_i = n_pairs(i, 1);
    n_j = n_pairs(i, 2);
    
    subplot(1, 3, i); % Три диаграммы рассеяния на одном полотне
    scatter(Xi(n_i, :), Xi(n_j, :), 'filled');
    xlabel(['\xi[n = ' num2str(n_i) ']']);
    ylabel(['\xi[n = ' num2str(n_j) ']']);
    title(['Диаграмма рассеяния: n = ' num2str(n_i) ' и n = ' num2str(n_j)]);
    grid on;
end

% 3. Расчет выборочной корреляции между n_i и n_j
disp('Выборочные корреляции между парами (n_i, n_j):');
for i = 1:3
    n_i = n_pairs(i, 1);
    n_j = n_pairs(i, 2);
    r = corr(Xi(n_i, :)', Xi(n_j, :)');
    disp(['Корреляция между n = ' num2str(n_i) ' и n = ' num2str(n_j) ': r = ' num2str(r)]);
end
