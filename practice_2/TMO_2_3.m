% Параметры
N = 400;     % Длина процесса
K = 800;     % Количество реализаций
mu = 0;      % Среднее белого шума
sigma = 1;   % СКО белого шума
l1 = 4;      % Дополнительный параметр 1
l2 = 40;     % Дополнительный параметр 2

% Генерация белого шума
omega = mu + sigma * randn(N, K);

% Инициализация процесса случайного блуждания с затуханием
X = zeros(N, K);
X(1, :) = omega(1, :);  % Начальное значение

% Заполнение процесса случайного блуждания с затуханием по уравнению (2.3)
for n = 2:N
    X(n, :) = 0.9 * X(n-1, :) + omega(n, :);
end

% Построение всех реализаций на одном полотне
figure;
plot(1:N, X);
xlabel('n');
ylabel('\xi[n]');
title('Все реализации случайного блуждания с затуханием');
grid on;

% Использование l1 и l2 в качестве индексов для скаттерограмм
ni_nj_pairs_1 = [l1+10, l1+9; l1+50, l1+49; l1+100, l1+99; l1+200, l1+199];
ni_nj_pairs_2 = [l2+50, l2+40; l2+100, l2+90; l2+200, l2+190];

figure;
subplot(1, 2, 1); % Первый набор пар (соседние значения с l1)
hold on;
for pair = 1:size(ni_nj_pairs_1, 1)
    scatter(X(ni_nj_pairs_1(pair, 1), :), X(ni_nj_pairs_1(pair, 2), :));
end
hold off;
xlabel('\xi[n_i]');
ylabel('\xi[n_j]');
title(['Скаттерограммы для соседних n_i и n_j (с l1=', num2str(l1), ')']);
legend('n=10,9', 'n=50,49', 'n=100,99', 'n=200,199');
grid on;

subplot(1, 2, 2); % Второй набор пар (с l2)
hold on;
for pair = 1:size(ni_nj_pairs_2, 1)
    scatter(X(ni_nj_pairs_2(pair, 1), :), X(ni_nj_pairs_2(pair, 2), :));
end
hold off;
xlabel('\xi[n_i]');
ylabel('\xi[n_j]');
title(['Скаттерограммы для пар (n_i, n_j) (с l2=', num2str(l2), ')']);
legend('n=50,40', 'n=100,90', 'n=200,190');
grid on;

% Рассчет выборочной автокорреляции r(n, n-1)
auto_corr_sample = zeros(N-1, 1);
for n = 2:N
    auto_corr_sample(n-1) = mean(X(n, :) .* X(n-1, :));
end

% Теоретическая автокорреляция r(n, n-1) для случайного блуждания с затуханием
auto_corr_theory = (sigma^2) * 0.9 .^ (1:N-1)';

% Построение выборочной и теоретической автокорреляций
figure;
plot(1:N-1, auto_corr_sample, 'b', 'LineWidth', 2);
hold on;
plot(1:N-1, auto_corr_theory, 'r--', 'LineWidth', 2);
xlabel('n');
ylabel('r(n, n-1)');
title('Выборочная и теоретическая автокорреляции r(n, n-1) для случайного блуждания с затуханием');
legend('Выборочная автокорреляция', 'Теоретическая автокорреляция');
grid on;
hold off;

% График АКФ для белого шума, случайного блуждания и случайного блуждания с затуханием
% (по аналогии с тем, что указано в пункте 10)
